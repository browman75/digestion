<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>器官拼圖 (v6 - 最終修正)</title>
    <style>
        :root {
            --bg-color: #f0f0f0;
            --main-color: #333;
            --accent-color: #4a90e2;
            --correct-color: #28a745;
            --font-family: 'Helvetica Neue', 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            --drop-zone-bg: rgba(74, 144, 226, 0.1);
            --drop-zone-border: rgba(74, 144, 226, 0.5);
            --drop-zone-hover-bg: rgba(74, 144, 226, 0.3);
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--main-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            -webkit-touch-callout: none; -webkit-user-select: none;
            -khtml-user-select: none; -moz-user-select: none;
            -ms-user-select: none; user-select: none;
        }

        h1 { color: var(--main-color); }

        .game-container {
            display: flex;
            flex-direction: row;
            gap: 20px;
            width: 95%;
            max-width: 1200px;
            height: 80vh;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        #puzzle-area {
            flex: 2;
            position: relative;
            background-image: url('./images/organ1_body.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            border: 2px dashed #ccc;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .static-label {
            position: absolute;
            top: 7%;
            left: 70%;
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            z-index: 2;
            pointer-events: none;
        }

        #pieces-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 10px;
            overflow-y: auto;
            background-color: #fafafa;
        }
        
        #pieces-bank h3 {
            text-align: center;
            margin: 5px 0 15px 0;
            font-size: 1.2em;
        }

        #organ-pieces, #label-pieces {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            align-items: center;
        }

        .draggable {
            cursor: grab;
            transition: transform 0.2s;
            touch-action: none;
            border: 2px solid transparent; 
            box-sizing: border-box; 
        }
        
        .draggable-icon {
            object-fit: contain;
        }

        .draggable-label {
            padding: 8px 15px;
            background-color: #fff;
            border: 2px solid var(--accent-color);
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .dragging {
            cursor: grabbing;
            transform: scale(1.1);
            z-index: 1000; /* Highest z-index */
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        /* MODIFIED: Added z-index: 2 to keep pieces above drop zones */
        .on-board { 
            position: absolute;
            z-index: 2; 
        }

        .drop-zone {
            position: absolute;
            background-color: var(--drop-zone-bg);
            border: 1px dashed var(--drop-zone-border);
            border-radius: 5px;
            z-index: 1; /* Lower z-index */
        }

        .drop-zone.hover {
            background-color: var(--drop-zone-hover-bg);
            border: 2px solid var(--accent-color);
        }
        
        /* Drop Zone Positions & Layering */
        #drop-mouth-img { top: 16%; left: 42%; width: 9%; height: 5.5%; }
        #drop-pharynx-img { top: 17.5%; left: 50%; width: 2%; height: 5.5%; }
        #drop-esophagus-img { top: 22.5%; left: 50.5%; width: 3%; height: 18%; }
        #drop-liver-img { top: 40%; left: 38%; width: 15%; height: 10%; z-index: 4; }
        #drop-stomach-img { top: 40.5%; left: 48%; width: 12%; height: 13%; z-index: 2; }
        #drop-pancreas-img { top: 49%; left: 43%; width: 12%; height: 8%; }
        #drop-large-intestine-img { top: 53%; left: 38%; width: 25%; height: 24%; z-index: 3; }
        /* MODIFIED: Small intestine height changed from 28% to 22% */
        #drop-small-intestine-img { top: 46%; left: 40%; width: 20%; height: 22%; z-index: 2; } 
        
        #drop-mouth-label { top: 12%; left: 70%; width: 10%; height: 5%; }
        #drop-pharynx-label { top: 19%; left: 70%; width: 10%; height: 5%; }
        #drop-esophagus-label { top: 27%; left: 70%; width: 10%; height: 5%; }
        #drop-liver-label { top: 35%; left: 10%; width: 10%; height: 5%; }
        #drop-stomach-label { top: 42%; left: 70%; width: 10%; height: 5%; }
        #drop-pancreas-label { top: 52%; left: 55%; width: 10%; height: 5%; }
        #drop-small-intestine-label { top: 48%; left: 70%; width: 10%; height: 5%; }
        #drop-large-intestine-label { top: 55%; left: 70%; width: 10%; height: 5%; }

        .controls {
            width: 95%;
            max-width: 1200px;
            display: flex;
            justify-content: space-between;
